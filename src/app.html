import RiotControl from 'riotcontrol'

<app>

  <div class="ui container">
    <header>
      <div class="ui two item menu">
        <a class="item {active: _route == 'posts'}" href="#posts">Posts</a>
        <a class="item {active: _route == 'categories'}" href="#categories">Categories</a>
      </div>
    </header>
    <article>
      <div id="mainview"></div>
    </article>
    <footer>
      <div class="ui divider"></div>
      <div class="ui two row centered grid">
        <a href="#" onclick={resetData}>Reset Data</a>
        <a href="https://github.com/MD4" target="_blank">@MD4</a>
      </div>
    </footer>
  </div>

  <style scoped>
    header {
      margin: 40px;
    }
    footer {
      margin: 40px;
    }
    .ui.divider {
      margin: 30px;
    }
  </style>

  <script type="text/babel">
    this._currentView = null
    this._route = '';

    this.resetData = () => {
      RiotControl.trigger(riot.VE.RESET_DATA)
    }

    this.loadView = (viewName, id) => {
      if (this._currentView) {
        this._currentView.unmount(true)
      }
      this._currentView = riot.mount('div#mainview', viewName, { data: id })[ 0 ]
    }

    this.studyRoute = (view, id) => {
      switch (view) {
        case 'categories':
          this.loadView('categories-view')
          break
        case 'detail':
          this.loadView('detail-view', id)
          break
        case 'posts':
          this.loadView('posts-view')
          break
        default:
          this.loadView('posts-view')
      }
      this._route = view;
      this.update();
    }

    riot.route(this.studyRoute)

    this.on('mount', () => {
      riot.route.start(true)
    })
  </script>
</app>
